<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contractor Dashboard</title>
    <link rel="stylesheet" href="admin-style.css">
</head>

<body>
    <!-- MCD Government Header -->
    <header class="mcd-header">
        <div class="mcd-header-container">
            <div class="mcd-logo-section">
                <a href="contractor.html" class="mcd-logo-link" title="Refresh Dashboard">
                    <img src="mcd-logo.png" alt="MCD Logo" class="mcd-logo-img">
                </a>
            </div>
            <div class="mcd-title-center">
                <h1 class="mcd-page-title">Contractor Dashboard</h1>
            </div>
            <div class="mcd-user-section">
                <div class="user-icon-wrapper" title="User Account">
                    <svg class="user-icon" width="40" height="40" viewBox="0 0 24 24" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="8" r="4" fill="#1a5490" />
                        <path d="M4 20C4 16.6863 6.68629 14 10 14H14C17.3137 14 20 16.6863 20 20V21H4V20Z"
                            fill="#1a5490" />
                    </svg>
                    <div class="user-email-tooltip" id="userEmail"></div>
                </div>
                <!-- Notifications Bell -->
                <div class="notifications-wrapper" style="position: relative;">
                    <button onclick="toggleNotifications()" class="notification-btn"
                        style="background: none; border: none; cursor: pointer; position: relative; padding: 8px;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M18 8C18 6.4087 17.3679 4.88258 16.2426 3.75736C15.1174 2.63214 13.5913 2 12 2C10.4087 2 8.88258 2.63214 7.75736 3.75736C6.63214 4.88258 6 6.4087 6 8C6 15 3 17 3 17H21C21 17 18 15 18 8Z"
                                stroke="#1a5490" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            <path
                                d="M13.73 21C13.5542 21.3031 13.3019 21.5547 12.9982 21.7295C12.6946 21.9044 12.3504 21.9965 12 21.9965C11.6496 21.9965 11.3054 21.9044 11.0018 21.7295C10.6982 21.5547 10.4458 21.3031 10.27 21"
                                stroke="#1a5490" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        <span id="notificationBadge" class="notification-badge"
                            style="display: none; position: absolute; top: 4px; right: 4px; background: #dc3545; color: white; border-radius: 50%; width: 18px; height: 18px; font-size: 0.7rem; display: flex; align-items: center; justify-content: center; font-weight: bold;">0</span>
                    </button>
                    <div id="notificationsDropdown" class="notifications-dropdown"
                        style="display: none; position: absolute; right: 0; top: 100%; width: 350px; max-height: 400px; overflow-y: auto; background: white; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.15); z-index: 1000; margin-top: 8px;">
                        <div
                            style="padding: 15px; border-bottom: 1px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center;">
                            <h3 style="margin: 0; font-size: 1rem; color: #1a5490;">Notifications</h3>
                            <button onclick="markAllRead()"
                                style="background: none; border: none; color: #1a5490; font-size: 0.85rem; cursor: pointer; text-decoration: underline;">Mark
                                all read</button>
                        </div>
                        <div id="notificationsList" style="padding: 10px;">
                            <p style="text-align: center; color: #666; padding: 20px;">Loading...</p>
                        </div>
                    </div>
                </div>
                <button onclick="logout()" class="mcd-logout-btn">Logout</button>
            </div>
        </div>
    </header>

    <!-- Navigation Bar -->
    <nav class="admin-navbar">
        <div class="admin-nav-container">
            <a href="#dashboard" class="nav-item active" onclick="setActiveNav(this)">
                <span class="nav-text">Dashboard</span>
            </a>
            <a href="#recent-activity" class="nav-item" onclick="setActiveNav(this)">
                <span class="nav-text">Recent Activity</span>
            </a>
            <a href="#vehicle-management" class="nav-item" onclick="setActiveNav(this)">
                <span class="nav-text">Vehicle Management</span>
            </a>
        </div>
    </nav>

    <div class="container">
        <!-- Dashboard Section -->
        <section id="dashboard">
            <!-- Quick Stats Cards -->
            <div class="stats-grid"
                style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px;">
                <div class="command-stat-card green-border">
                    <p class="stat-label">VEHICLES IN</p>
                    <h2 class="stat-value" id="todayEntries">0</h2>
                    <p class="stat-subtitle">Today's Entries</p>
                </div>
                <div class="command-stat-card red-border">
                    <p class="stat-label">VEHICLES OUT</p>
                    <h2 class="stat-value" id="todayExits">0</h2>
                    <p class="stat-subtitle">Today's Exits</p>
                </div>
                <div class="command-stat-card blue-border">
                    <p class="stat-label">CURRENT OCCUPANCY</p>
                    <h2 class="stat-value" id="currentOccupancyStat">0</h2>
                    <p class="stat-subtitle">Vehicles Parked</p>
                </div>
            </div>

            <!-- Parking Lot Info -->
            <div class="card"
                style="background: linear-gradient(135deg, #1a5490 0%, #2d6ba8 100%); color: white; border: none; box-shadow: 0 4px 15px rgba(26, 84, 144, 0.3);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <div>
                        <p
                            style="margin: 0; font-size: 0.7rem; opacity: 0.9; letter-spacing: 0.3px; text-transform: uppercase;">
                            Parking Location</p>
                        <h2 id="parkingLotName"
                            style="margin: 3px 0 0 0; color: white; font-size: 1.1rem; font-weight: 700;">Loading...
                        </h2>
                    </div>
                    <div
                        style="background: rgba(255,255,255,0.15); padding: 8px; border-radius: 6px; backdrop-filter: blur(10px);">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="white" opacity="0.9" />
                            <path d="M2 17L12 22L22 17V12L12 17L2 12V17Z" fill="white" opacity="0.7" />
                        </svg>
                    </div>
                </div>

                <div
                    style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);">
                    <div class="occupancy-display">
                        <div class="occupancy-number" id="occupancyDisplay" style="margin-bottom: 6px;">
                            <span class="current" id="currentOccupancy"
                                style="color: #ffa500; font-size: 2rem; font-weight: 800;">0</span>
                            <span class="separator"
                                style="color: rgba(255,255,255,0.6); font-size: 1.6rem; margin: 0 6px;">/</span>
                            <span class="max" id="maxCapacity"
                                style="color: white; font-size: 1.6rem; font-weight: 600;">0</span>
                        </div>
                        <p class="occupancy-label"
                            style="color: rgba(255,255,255,0.9); font-size: 0.8rem; margin: 0; letter-spacing: 0.2px;">
                            Current Occupancy / Maximum Capacity</p>
                    </div>
                </div>

                <div id="statusBadge" class="status-badge status-normal"
                    style="margin-top: 15px; padding: 10px 16px; border-radius: 6px; text-align: center; font-weight: 600; font-size: 0.9rem; background: rgba(255,255,255,0.2); color: white; border: 2px solid rgba(255,255,255,0.3);">
                    Normal Operation
                </div>
            </div>

            <!-- Today's Summary -->
            <div class="card" style="margin-top: 20px;">
                <h3
                    style="color: #1a5490; margin-bottom: 12px; font-size: 1.1rem; font-weight: 700; border-bottom: 3px solid #ffa500; padding-bottom: 6px;">
                    Today's Summary</h3>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
                    <div
                        style="padding: 12px; background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); border-radius: 6px; border-left: 3px solid #28a745; box-shadow: 0 2px 4px rgba(0,0,0,0.08); transition: transform 0.3s ease;">
                        <p
                            style="margin: 0; font-size: 0.7rem; color: #666; font-weight: 600; text-transform: uppercase; letter-spacing: 0.3px;">
                            Peak Occupancy</p>
                        <h3 style="margin: 6px 0 0 0; color: #28a745; font-size: 1.3rem; font-weight: 700;"
                            id="peakOccupancy">0</h3>
                    </div>
                    <div
                        style="padding: 12px; background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); border-radius: 6px; border-left: 3px solid #5b9bd5; box-shadow: 0 2px 4px rgba(0,0,0,0.08); transition: transform 0.3s ease;">
                        <p
                            style="margin: 0; font-size: 0.7rem; color: #666; font-weight: 600; text-transform: uppercase; letter-spacing: 0.3px;">
                            Average Duration</p>
                        <h3 style="margin: 6px 0 0 0; color: #5b9bd5; font-size: 1.3rem; font-weight: 700;"
                            id="avgDuration">0 min</h3>
                    </div>
                    <div
                        style="padding: 12px; background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); border-radius: 6px; border-left: 3px solid #ffa500; box-shadow: 0 2px 4px rgba(0,0,0,0.08); transition: transform 0.3s ease;">
                        <p
                            style="margin: 0; font-size: 0.7rem; color: #666; font-weight: 600; text-transform: uppercase; letter-spacing: 0.3px;">
                            Total Transactions</p>
                        <h3 style="margin: 6px 0 0 0; color: #ffa500; font-size: 1.3rem; font-weight: 700;"
                            id="totalTransactions">0</h3>
                    </div>
                    <div
                        style="padding: 12px; background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); border-radius: 6px; border-left: 3px solid #9b59b6; box-shadow: 0 2px 4px rgba(0,0,0,0.08); transition: transform 0.3s ease;">
                        <p
                            style="margin: 0; font-size: 0.7rem; color: #666; font-weight: 600; text-transform: uppercase; letter-spacing: 0.3px;">
                            Utilization Rate</p>
                        <h3 style="margin: 6px 0 0 0; color: #9b59b6; font-size: 1.3rem; font-weight: 700;"
                            id="utilizationRate">0%</h3>
                    </div>
                </div>
            </div>

            <!-- Shift Information -->
            <div class="card"
                style="margin-top: 20px; background: #1a5490; color: white; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);">
                <h3 style="color: white;">Current Shift Information</h3>

                <!-- Shift Selection Buttons -->
                <div style="margin: 15px 0; display: flex; gap: 10px;">
                    <button id="morningShiftBtn" onclick="selectShift('morning')"
                        style="flex: 1; padding: 10px; background: rgba(255,255,255,0.2); color: white; border: 2px solid white; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 0.95rem;">
                        Morning Shift
                    </button>
                    <button id="nightShiftBtn" onclick="selectShift('night')"
                        style="flex: 1; padding: 10px; background: rgba(255,255,255,0.1); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 0.95rem;">
                        Night Shift
                    </button>
                </div>

                <!-- Shift Status -->
                <div
                    style="margin: 15px 0; padding: 12px; background: rgba(255,255,255,0.1); border-radius: 8px; text-align: center;">
                    <p style="margin: 0; font-size: 0.9rem; opacity: 0.9;">Shift Status</p>
                    <h3 style="margin: 8px 0; font-size: 1.3rem; color: #000000;" id="shiftStatus">Not Started</h3>
                </div>

                <!-- Shift Details Grid -->
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 15px;">
                    <div>
                        <p style="margin: 0; font-size: 0.85rem; opacity: 0.9;">Shift Started</p>
                        <h4 style="margin: 5px 0;" id="shiftStartTime">--:--</h4>
                        <p style="margin: 5px 0 0 0; font-size: 0.75rem; opacity: 0.7;" id="scheduledStart">Scheduled:
                            9:00 AM</p>
                    </div>
                    <div>
                        <p style="margin: 0; font-size: 0.85rem; opacity: 0.9;">Shift Ended</p>
                        <h4 style="margin: 5px 0;" id="shiftEndTime">--:--</h4>
                        <p style="margin: 5px 0 0 0; font-size: 0.75rem; opacity: 0.7;" id="scheduledEnd">Scheduled:
                            5:00 PM</p>
                    </div>
                    <div>
                        <p style="margin: 0; font-size: 0.85rem; opacity: 0.9;">Time Elapsed</p>
                        <h4 style="margin: 5px 0; font-size: 1.2rem; font-weight: bold;" id="timeElapsed">00:00:00</h4>
                    </div>
                </div>

                <!-- Shift Control Buttons -->
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button id="startShiftBtn" onclick="startShift()"
                        style="flex: 1; padding: 12px; background: #28a745; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 1rem;">
                        Start Shift
                    </button>
                    <button id="endShiftBtn" onclick="endShift()" disabled
                        style="flex: 1; padding: 12px; background: #dc3545; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 1rem; opacity: 0.5;">
                        End Shift
                    </button>
                </div>
            </div>

            <!-- Alerts & Notifications -->
            <div class="card" style="margin-top: 20px;">
                <h3
                    style="color: #1a5490; margin-bottom: 10px; font-size: 1.1rem; font-weight: 700; border-bottom: 3px solid #ffa500; padding-bottom: 6px;">
                    Alerts & Notifications</h3>
                <div id="alertsContainer" style="margin-top: 15px;">
                    <div class="alert-item"
                        style="padding: 12px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 5px; margin-bottom: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.06);">
                        <strong style="color: #856404; font-size: 0.85rem;">Capacity Warning:</strong> <span
                            style="color: #856404; font-size: 0.85rem;">Parking lot is approaching full capacity</span>
                    </div>
                    <div class="alert-item"
                        style="padding: 12px; background: #d1ecf1; border-left: 4px solid #17a2b8; border-radius: 5px; margin-bottom: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.06);">
                        <strong style="color: #0c5460; font-size: 0.85rem;">Reminder:</strong> <span
                            style="color: #0c5460; font-size: 0.85rem;">Log all vehicle entries and exits
                            accurately</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Vehicle Management Section -->
        <section id="vehicle-management">
            <div class="card"
                style="background: linear-gradient(135deg, #1a5490 0%, #2d6ba8 100%); color: white; border: none; box-shadow: 0 4px 15px rgba(26, 84, 144, 0.3);">
                <h3
                    style="color: white; margin-bottom: 12px; font-size: 1.1rem; font-weight: 700; border-bottom: 3px solid #ffa500; padding-bottom: 6px;">
                    Vehicle Management</h3>

                <p style="margin: 0 0 15px 0; color: rgba(255,255,255,0.9); font-size: 0.9rem; line-height: 1.5;">
                    Use the buttons below to log vehicle entries and exits. Ensure accurate recording of all
                    transactions.
                </p>

                <!-- Vehicle Entry Form -->
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <h4 style="margin: 0 0 12px 0; color: white; font-size: 0.95rem;">Vehicle Details</h4>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                        <div>
                            <label
                                style="display: block; margin-bottom: 6px; font-size: 0.85rem; color: rgba(255,255,255,0.9);">Vehicle
                                Type</label>
                            <select id="vehicleType"
                                style="width: 100%; padding: 10px; border-radius: 6px; border: 2px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.95); font-size: 0.9rem;">
                                <option value="2-wheeler">2-Wheeler (₹10/hr)</option>
                                <option value="4-wheeler">4-Wheeler (₹20/hr)</option>
                                <option value="heavy">Heavy Vehicle (₹50/hr)</option>
                            </select>
                        </div>
                        <div>
                            <label
                                style="display: block; margin-bottom: 6px; font-size: 0.85rem; color: rgba(255,255,255,0.9);">Vehicle
                                Number</label>
                            <input type="text" id="vehicleNumber" placeholder="DL01AB1234"
                                style="width: 100%; padding: 10px; border-radius: 6px; border: 2px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.95); font-size: 0.9rem; text-transform: uppercase;">
                        </div>
                    </div>

                    <div
                        style="background: rgba(255,193,7,0.2); padding: 10px; border-radius: 6px; border-left: 4px solid #ffc107;">
                        <p style="margin: 0; font-size: 0.85rem; color: white;">
                            <strong>Pricing:</strong> 2-Wheeler: ₹10/hr | 4-Wheeler: ₹20/hr | Heavy: ₹50/hr
                        </p>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 15px;">
                    <!-- Entry Button -->
                    <button onclick="logEntry()" id="entryBtn"
                        style="padding: 15px 20px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; border: none; border-radius: 6px; font-weight: 600; font-size: 0.95rem; cursor: pointer; box-shadow: 0 2px 6px rgba(40, 167, 69, 0.4); transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 5V19M5 12H19" stroke="white" stroke-width="2.5" stroke-linecap="round" />
                        </svg>
                        Vehicle Entry
                    </button>

                    <!-- Exit Button -->
                    <button onclick="logExit()" id="exitBtn"
                        style="padding: 15px 20px; background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); color: white; border: none; border-radius: 6px; font-weight: 600; font-size: 0.95rem; cursor: pointer; box-shadow: 0 2px 6px rgba(255, 193, 7, 0.4); transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 12H19" stroke="white" stroke-width="2.5" stroke-linecap="round" />
                        </svg>
                        Vehicle Exit
                    </button>
                </div>

                <!-- Action Message -->
                <div id="actionMessage"
                    style="display: none; padding: 12px; border-radius: 5px; font-size: 0.9rem; font-weight: 500; margin-top: 10px;">
                </div>
            </div>
        </section>

        <!-- Recent Activity Section -->
        <section id="recent-activity">
            <!-- Recent Activity -->
            <div class="card">
                <h3
                    style="color: #1a5490; margin-bottom: 12px; font-size: 1.1rem; font-weight: 700; border-bottom: 3px solid #ffa500; padding-bottom: 6px;">
                    Recent Activity</h3>
                <div id="recentLogs" class="logs-container">
                    <p class="text-muted">Loading recent activity...</p>
                </div>
            </div>

            <!-- Quick Reference Guide -->
            <div class="card" style="margin-top: 20px; background: #1a5490; color: white;">
                <h3 style="color: white; margin-bottom: 10px; font-size: 1.1rem; font-weight: 700;">Quick Reference
                    Guide</h3>
                <div style="margin-top: 15px;">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                        <div
                            style="padding: 12px; background: rgba(255, 255, 255, 0.15); border-radius: 6px; border-left: 3px solid #28a745; backdrop-filter: blur(5px);">
                            <h4 style="margin: 0 0 10px 0; color: #90ee90; font-size: 0.95rem; font-weight: 700;">
                                Vehicle
                                Entry Steps</h4>
                            <ol style="margin: 0; padding-left: 20px; font-size: 0.85rem; color: white;">
                                <li>Click "Vehicle Entry" button</li>
                                <li>Verify available space</li>
                                <li>Confirm entry in system</li>
                                <li>Guide vehicle to parking spot</li>
                            </ol>
                        </div>
                        <div
                            style="padding: 12px; background: rgba(255, 255, 255, 0.15); border-radius: 6px; border-left: 3px solid #ffa500; backdrop-filter: blur(5px);">
                            <h4 style="margin: 0 0 10px 0; color: #ffd966; font-size: 0.95rem; font-weight: 700;">
                                Vehicle
                                Exit Steps</h4>
                            <ol style="margin: 0; padding-left: 20px; font-size: 0.85rem; color: white;">
                                <li>Click "Vehicle Exit" button</li>
                                <li>Verify vehicle details</li>
                                <li>Confirm exit in system</li>
                                <li>Update occupancy count</li>
                            </ol>
                        </div>
                    </div>
                    <div
                        style="margin-top: 12px; padding: 12px; background: rgba(255, 255, 255, 0.15); border-radius: 6px; border-left: 3px solid #ffa500; backdrop-filter: blur(5px);">
                        <h4 style="margin: 0 0 10px 0; color: #ffa500; font-size: 0.95rem; font-weight: 700;">Emergency
                            Contacts</h4>
                        <div
                            style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; font-size: 0.85rem; color: white;">
                            <div><strong>MCD Helpline:</strong> 155305</div>
                            <div><strong>Supervisor:</strong> +91-XXXX-XXXXXX</div>
                            <div><strong>Security:</strong> +91-XXXX-XXXXXX</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="mcd-footer">
        <div class="footer-bottom">
            <p>&copy; 2026 Municipal Corporation of Delhi. All Rights Reserved.</p>
            <p>Smart Parking Management System | Designed & Developed for MCD Hackathon</p>
        </div>
    </footer>

    <script src="contractor.js"></script>
</body>

</html>