<!DOCTYPE html>
<html lang="en">

<head>`r`n    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCD Admin Dashboard</title>
    <link rel="stylesheet" href="admin-style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <!-- Indian Flag Strip -->
    <div class="indian-flag-strip">
        <div class="flag-saffron"></div>
        <div class="flag-white"></div>
        <div class="flag-green"></div>
    </div>

    <!-- MCD Government Header -->
    <header class="mcd-header">
        <div class="mcd-header-container">
            <div class="mcd-logo-section">
                <a href="#" onclick="location.reload(); return false;" class="mcd-logo-link" title="Refresh Dashboard">
                    <img src="mcd-logo.png" alt="MCD Logo" class="mcd-logo-img">
                </a>
            </div>
            <div class="mcd-title-center">
                <h1 class="mcd-page-title">SPMS-Admin Page</h1>
            </div>
            <div class="mcd-user-section">
                <div class="user-icon-wrapper" title="User Account">
                    <svg class="user-icon" width="40" height="40" viewBox="0 0 24 24" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="8" r="4" fill="#1a5490" />
                        <path d="M4 20C4 16.6863 6.68629 14 10 14H14C17.3137 14 20 16.6863 20 20V21H4V20Z"
                            fill="#1a5490" />
                    </svg>
                    <div class="user-email-tooltip" id="userEmail"></div>
                </div>
                <!-- Notifications Bell -->
                <div class="notifications-wrapper" style="position: relative;">
                    <button onclick="toggleNotifications()" class="notification-btn"
                        style="background: none; border: none; cursor: pointer; position: relative; padding: 8px;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M18 8C18 6.4087 17.3679 4.88258 16.2426 3.75736C15.1174 2.63214 13.5913 2 12 2C10.4087 2 8.88258 2.63214 7.75736 3.75736C6.63214 4.88258 6 6.4087 6 8C6 15 3 17 3 17H21C21 17 18 15 18 8Z"
                                stroke="#1a5490" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            <path
                                d="M13.73 21C13.5542 21.3031 13.3019 21.5547 12.9982 21.7295C12.6946 21.9044 12.3504 21.9965 12 21.9965C11.6496 21.9965 11.3054 21.9044 11.0018 21.7295C10.6982 21.5547 10.4458 21.3031 10.27 21"
                                stroke="#1a5490" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        <span id="notificationBadge" class="notification-badge"
                            style="display: none; position: absolute; top: 4px; right: 4px; background: #dc3545; color: white; border-radius: 50%; width: 18px; height: 18px; font-size: 0.7rem; display: flex; align-items: center; justify-content: center; font-weight: bold;">0</span>
                    </button>
                    <div id="notificationsDropdown" class="notifications-dropdown"
                        style="display: none; position: absolute; right: 0; top: 100%; width: 350px; max-height: 400px; overflow-y: auto; background: white; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.15); z-index: 1000; margin-top: 8px;">
                        <div
                            style="padding: 15px; border-bottom: 1px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center;">
                            <h3 style="margin: 0; font-size: 1rem; color: #1a5490;">Notifications</h3>
                            <button onclick="markAllRead()"
                                style="background: none; border: none; color: #1a5490; font-size: 0.85rem; cursor: pointer; text-decoration: underline;">Mark
                                all read</button>
                        </div>
                        <div id="notificationsList" style="padding: 10px;">
                            <p style="text-align: center; color: #666; padding: 20px;">Loading...</p>
                        </div>
                    </div>
                </div>
                <button onclick="logout()" class="mcd-logout-btn">Logout</button>
            </div>
        </div>
    </header>

    <!-- Navigation Bar -->
    <nav class="admin-navbar">
        <div class="admin-nav-container">
            <a href="#dashboard" class="nav-item active" onclick="setActiveNav(this)">
                <span class="nav-text">Dashboard</span>
            </a>
            <a href="contractor-management.html" class="nav-item">
                <span class="nav-text">Contractor Management</span>
            </a>
            <a href="#violations-section" class="nav-item" onclick="setActiveNav(this)">
                <span class="nav-text">Violations Over Time</span>
            </a>
            <a href="data-integrity.html" class="nav-item">
                <span class="nav-text">Data Integrity Status</span>
            </a>
            <a href="registration.html" class="nav-item">
                <span class="nav-text">Registration</span>
            </a>
            <a href="settings.html" class="nav-item">
                <span class="nav-text">Settings</span>
            </a>
            <a href="issues.html" class="nav-item">
                <span class="nav-text">Issues</span>
            </a>
        </div>
    </nav>

    <div class="container">
        <!-- Dashboard Section -->
        <section id="dashboard">
            <!-- Administrative Overview Section -->
            <div class="admin-overview-section">
                <div class="section-header">
                    <div class="section-title-group">
                        <p class="section-label">ADMINISTRATIVE OVERVIEW</p>
                        <h1 class="section-main-title">City Command Center</h1>
                    </div>
                    <button onclick="downloadDailyReport()" class="btn-download-report">
                        <span class="download-icon">üì•</span> Download Daily Report
                    </button>
                </div>

                <!-- Command Center Stats Grid -->
                <div class="command-stats-grid">
                    <div class="command-stat-card green-border">
                        <p class="stat-label">TOTAL REVENUE</p>
                        <h2 class="stat-value" id="totalRevenue">‚Çπ0</h2>
                        <p class="stat-subtitle">Today's Collection</p>
                    </div>
                    <div class="command-stat-card red-border">
                        <p class="stat-label">ACTIVE VIOLATIONS</p>
                        <h2 class="stat-value" id="activeViolations">0</h2>
                        <p class="stat-subtitle">Action Required</p>
                    </div>
                    <div class="command-stat-card blue-border">
                        <p class="stat-label">VEHICLE COUNT</p>
                        <h2 class="stat-value" id="vehicleCount">0</h2>
                        <p class="stat-subtitle">All Zones</p>
                    </div>
                    <div class="command-stat-card purple-border">
                        <p class="stat-label">PENDING APPS</p>
                        <h2 class="stat-value" id="pendingApps">0</h2>
                        <p class="stat-subtitle">Review Queue</p>
                    </div>
                </div>
            </div>


            <!-- Parking Lots Overview -->
            <div class="card official-card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>üöó Parking Lots Status</h2>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="filterParkingLots('all')" class="filter-btn active" id="filterAll"
                            style="padding: 8px 16px; border: 2px solid #1a5490; background: #1a5490; color: white; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s;">
                            All Lots
                        </button>
                        <button onclick="filterParkingLots('live')" class="filter-btn" id="filterLive"
                            style="padding: 8px 16px; border: 2px solid #28a745; background: white; color: #28a745; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s;">
                            üü¢ Live Shifts
                        </button>
                        <button onclick="filterParkingLots('offline')" class="filter-btn" id="filterOffline"
                            style="padding: 8px 16px; border: 2px solid #6c757d; background: white; color: #6c757d; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s;">
                            ‚ö´ Offline
                        </button>
                    </div>
                </div>
                <div id="parkingLotsGrid" class="parking-lots-grid"
                    style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px;">
                    <p class="text-muted">Loading parking lots...</p>
                </div>
            </div>
        </section>

        <!-- Occupancy vs Capacity Section -->
        <section id="occupancy-section">
            <div class="card official-card">
                <h2>üÖøÔ∏è Occupancy vs Capacity</h2>
                <canvas id="occupancyChart"></canvas>
            </div>
        </section>

        <!-- Violations Over Time Section -->
        <section id="violations-section">
            <div class="card official-card">
                <h2>‚ö†Ô∏è Violations Over Time (7 Days)</h2>
                <canvas id="violationsChart"></canvas>
            </div>
        </section>

        <!-- Geographic Information System Section -->
        <section id="gis-section">
            <div class="gis-section">
                <div class="section-header-simple">
                    <div class="section-title-group">
                        <p class="section-label">GEOGRAPHIC INFORMATION SYSTEM</p>
                        <h2 class="section-subtitle">Live Parking Network</h2>
                    </div>
                    <div class="zone-filters">
                        <button class="zone-btn active" onclick="filterZone('all')">All Delhi</button>
                        <button class="zone-btn" onclick="filterZone('north')">North Delhi</button>
                        <button class="zone-btn" onclick="filterZone('south')">South Delhi</button>
                        <button class="zone-btn" onclick="filterZone('central')">Central Delhi</button>
                        <button class="zone-btn" onclick="filterZone('west')">West Delhi</button>
                        <button class="zone-btn" onclick="filterZone('east')">East Delhi</button>
                    </div>
                </div>

                <!-- Delhi Map Container -->
                <div class="delhi-map-container" style="position: relative;">
                    <!-- Map Controls Info -->
                    <div
                        style="position: absolute; top: 10px; right: 10px; z-index: 10; background: rgba(255,255,255,0.95); padding: 8px 12px; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.15); font-size: 0.75rem; color: #1a5490; font-weight: 600;">
                        üí° Click & drag to move | Scroll to zoom
                    </div>

                    <div id="mapLoadingIndicator"
                        style="display: none; text-align: center; padding: 100px; background: #f8f9fa; border-radius: 8px;">
                        <p style="color: #1a5490; font-size: 1.3rem; font-weight: 600;">Loading map...</p>
                    </div>
                    <iframe id="delhiMap"
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d224346.48129763652!2d76.87677984999999!3d28.52758485!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x390cfd5b347eb62d%3A0x52c2b7494e204dce!2sNew%20Delhi%2C%20Delhi!5e0!3m2!1sen!2sin!4v1234567890123!5m2!1sen!2sin"
                        width="100%" height="750"
                        style="border:0; border-radius: 8px; pointer-events: auto; cursor: grab;" allowfullscreen=""
                        loading="lazy" referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                </div>

                <!-- Zone Information Display -->
                <div id="zoneInfo"
                    style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #1a5490 0%, #2d6ba8 100%); border-radius: 8px; color: white; display: none;">
                    <h3 style="margin: 0 0 10px 0; font-size: 1.1rem; font-weight: 700;">Zone Information</h3>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                        <div>
                            <p style="margin: 0; font-size: 0.8rem; opacity: 0.9;">Zone Name</p>
                            <p id="zoneNameDisplay" style="margin: 5px 0 0 0; font-size: 1rem; font-weight: 600;">-</p>
                        </div>
                        <div>
                            <p style="margin: 0; font-size: 0.8rem; opacity: 0.9;">Parking Lots</p>
                            <p id="zoneParkingLots" style="margin: 5px 0 0 0; font-size: 1rem; font-weight: 600;">-</p>
                        </div>
                        <div>
                            <p style="margin: 0; font-size: 0.8rem; opacity: 0.9;">Total Capacity</p>
                            <p id="zoneTotalCapacity" style="margin: 5px 0 0 0; font-size: 1rem; font-weight: 600;">-
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="mcd-footer">
        <div class="footer-bottom">
            <p>&copy; 2026 Municipal Corporation of Delhi. All Rights Reserved.</p>
            <p>Smart Parking Management System | Designed & Developed for MCD Hackathon</p>
        </div>
    </footer>

    <script src="admin.js"></script>
</body>

</html>